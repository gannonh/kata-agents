---
phase: 02-rebranding
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/electron/resources/icon.icns
  - apps/electron/resources/icon.ico
  - apps/electron/resources/icon.png
  - apps/electron/resources/icon.svg
  - apps/electron/resources/source.png
  - apps/electron/resources/icon.icon/Assets/icon.svg
  - apps/electron/resources/dmg-background.png
  - apps/electron/resources/dmg-background.tiff
  - apps/electron/resources/craft-logos/
autonomous: true

must_haves:
  truths:
    - "Application icon displays Kata branding (amber mark on dark background)"
    - "macOS dock icon is Kata mark"
    - "Windows taskbar icon is Kata mark"
    - "DMG installer shows Kata branding"
  artifacts:
    - path: "apps/electron/resources/icon.icns"
      provides: "macOS application icon"
      min_lines: 0
    - path: "apps/electron/resources/icon.ico"
      provides: "Windows application icon"
      min_lines: 0
    - path: "apps/electron/resources/icon.png"
      provides: "Linux application icon (512x512)"
      min_lines: 0
    - path: "apps/electron/resources/icon.svg"
      provides: "SVG source icon"
      min_lines: 1
  key_links:
    - from: "assets/brand/icon-dark.svg"
      to: "apps/electron/resources/icon.svg"
      via: "Copy"
      pattern: "N/A (binary comparison)"
    - from: "apps/electron/resources/source.png"
      to: "apps/electron/resources/icon.icns"
      via: "generate-icons.sh"
      pattern: "N/A (binary)"
---

<objective>
Replace all application icons with Kata branding using existing brand assets and the generate-icons.sh script.

Purpose: Makes the application visually identifiable as Kata Agents in dock, taskbar, Finder, and installers.

Output: Complete set of platform-specific icons derived from Kata brand assets.
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-rebranding/02-RESEARCH.md

@apps/electron/resources/generate-icons.sh
</context>

<tasks>

<task type="auto">
  <name>Task 1: Generate source PNG from brand assets</name>
  <files>apps/electron/resources/source.png</files>
  <action>
The brand assets are in `assets/brand/`. We need a high-resolution PNG (1024x1024) for the icon generation script.

Option A - If logo-circle-dark.png exists at adequate resolution:
```bash
cp assets/brand/logo-circle-dark.png apps/electron/resources/source.png
# Verify dimensions
sips -g pixelHeight -g pixelWidth apps/electron/resources/source.png
# If less than 1024x1024, use Option B
```

Option B - Export from SVG using sips:
```bash
# First check what SVGs are available
ls -la assets/brand/*.svg

# The icon-dark.svg is the app icon with dark background + amber mark
# We need to convert SVG to PNG - sips can't do this directly
# Use qlmanage (Quick Look) for conversion on macOS:
qlmanage -t -s 1024 -o /tmp assets/brand/icon-dark.svg
mv /tmp/icon-dark.svg.png apps/electron/resources/source.png
```

Option C - If qlmanage doesn't work, check if there's already a suitable PNG:
```bash
ls -la assets/brand/*.png
# Use logo-circle-dark.png if it exists
```

Verify the source.png is at least 1024x1024:
```bash
sips -g pixelHeight -g pixelWidth apps/electron/resources/source.png
```
  </action>
  <verify>
sips -g pixelHeight -g pixelWidth apps/electron/resources/source.png
# Should show at least 1024x1024
  </verify>
  <done>
source.png exists at apps/electron/resources/source.png with minimum 1024x1024 resolution
  </done>
</task>

<task type="auto">
  <name>Task 2: Generate platform icons using existing script</name>
  <files>
    apps/electron/resources/icon.icns
    apps/electron/resources/icon.ico
    apps/electron/resources/icon.png
    apps/electron/resources/icon.svg
    apps/electron/resources/icon.icon/Assets/icon.svg
  </files>
  <action>
Run the existing icon generation script:

```bash
cd apps/electron/resources
./generate-icons.sh source.png
```

The script handles:
- Creating icon.iconset with all required sizes (16x16 to 512x512@2x)
- Generating icon.icns for macOS
- Generating icon.png (512x512) for Linux
- Generating icon.ico for Windows (if ImageMagick is available)

After script runs:
1. Copy the SVG source for reference:
   ```bash
   cp ../../../assets/brand/icon-dark.svg icon.svg
   ```

2. Update the Liquid Glass icon (macOS 26+):
   ```bash
   cp ../../../assets/brand/mark.svg icon.icon/Assets/icon.svg
   ```
   Note: The Liquid Glass icon should be just the mark without background (macOS adds its own glass effect).

3. If icon.ico wasn't generated (ImageMagick not installed), we can proceed without it - electron-builder will generate from icns.
  </action>
  <verify>
ls -la apps/electron/resources/icon.icns apps/electron/resources/icon.png apps/electron/resources/icon.svg
# All files should exist and be recently modified
file apps/electron/resources/icon.icns
# Should show "Mac OS X icon"
  </verify>
  <done>
icon.icns, icon.png, and icon.svg all exist with Kata branding
  </done>
</task>

<task type="auto">
  <name>Task 3: Update DMG background and remove Craft logos</name>
  <files>
    apps/electron/resources/dmg-background.png
    apps/electron/resources/dmg-background.tiff
    apps/electron/resources/craft-logos/
  </files>
  <action>
1. For the DMG background, we have two options:

   Option A - Create a simple solid background (recommended for now):
   The current DMG background shows the Craft logo. Create a minimal replacement:
   ```bash
   # Create a simple dark background (540x380 is the DMG window size from electron-builder.yml)
   # Use sips to create a solid color image
   # First, copy source.png as a base and resize
   sips -z 380 540 --padColor 18181B apps/electron/resources/source.png --out /tmp/dmg-bg-temp.png
   # This won't work perfectly - sips doesn't do solid fills easily
   ```

   Better approach - just use a placeholder for now:
   The DMG will still work with the old background (it just shows the Craft design).
   Leave a TODO comment in the SUMMARY for proper DMG background design.

2. Remove the old Craft logos directory:
   ```bash
   rm -rf apps/electron/resources/craft-logos
   ```

3. If time permits, create dmg-background.tiff:
   ```bash
   # If we have a new dmg-background.png:
   sips -s format tiff dmg-background.png --out dmg-background.tiff
   ```

Note: The DMG background is cosmetic and won't block the release. The app icon is more important.
  </action>
  <verify>
ls apps/electron/resources/craft-logos 2>/dev/null || echo "craft-logos removed: OK"
# Should show "craft-logos removed: OK"
  </verify>
  <done>
Craft logos directory is removed. DMG background either updated or flagged for future design work.
  </done>
</task>

</tasks>

<verification>
After completing all tasks:

1. Icon files exist:
```bash
ls -la apps/electron/resources/icon.{icns,ico,png,svg} 2>/dev/null | wc -l
# Should be at least 3 (ico may be optional)
```

2. Icon content verification:
```bash
file apps/electron/resources/icon.icns
# Should show "Mac OS X icon"
```

3. Craft logos removed:
```bash
test -d apps/electron/resources/craft-logos && echo "FAIL: craft-logos still exists" || echo "OK: craft-logos removed"
```

4. Build still works:
```bash
bun run electron:build
# Should complete without errors
```
</verification>

<success_criteria>
1. `file apps/electron/resources/icon.icns` shows "Mac OS X icon"
2. `apps/electron/resources/icon.png` is 512x512 pixels (verified via `sips -g pixelHeight`)
3. `apps/electron/resources/craft-logos/` directory does not exist
4. `bun run electron:build` completes without icon-related errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-rebranding/02-02-SUMMARY.md`
</output>
