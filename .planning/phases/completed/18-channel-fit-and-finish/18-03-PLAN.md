---
phase: 18-channel-fit-and-finish
plan: 03
type: execute
wave: 3
depends_on: [18-01, 18-02]
files_modified:
  - apps/electron/docs/slack-setup.md
autonomous: false
must_haves:
  truths:
    - A user with no prior Slack API experience can follow the guide to create a working Slack channel in Kata Agents
    - Guide covers Slack app creation, bot token scopes, app-level token (Socket Mode), channel ID retrieval, and Kata Agents configuration
    - Guide warns about common mistakes (wrong scopes, bot not invited to channel, Socket Mode not enabled)
  artifacts:
    - apps/electron/docs/slack-setup.md
  key_links:
    - Guide references actual UI field names from ChannelSettingsPage.tsx (Bot Token, App-Level Token, Channel IDs)
---

<objective>
Write a step-by-step Slack app setup guide that an end user can follow to connect a Slack workspace to Kata Agents. Covers creating the Slack app, configuring OAuth scopes, enabling Socket Mode, retrieving channel IDs, and entering credentials in Kata Agents.

Purpose: Users can self-serve Slack integration setup without needing to read Slack API documentation or ask for help.

Output: `apps/electron/docs/slack-setup.md` with complete walkthrough.
</objective>

<execution_context>
<!-- Executor agent has built-in instructions for plan execution and summary creation -->
</execution_context>

<context>
@.planning/phases/pending/18-channel-fit-and-finish/18-RESEARCH.md
@apps/electron/src/renderer/pages/settings/ChannelSettingsPage.tsx
@packages/shared/src/channels/types.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Write Slack setup guide</name>
  <files>
    apps/electron/docs/slack-setup.md
  </files>
  <action>
Create `apps/electron/docs/slack-setup.md` with a complete setup guide. The guide should cover:

**Prerequisites section:**
- A Slack workspace where the user has admin or app installation permissions
- Kata Agents desktop app installed and running with at least one workspace configured

**Part 1: Create a Slack App**
- Go to https://api.slack.com/apps
- Click "Create New App" -> "From scratch"
- Name the app (e.g., "Kata Agent") and select the workspace
- Note: Only the "new app model" is supported (classic apps are deprecated)

**Part 2: Configure Bot Token Scopes**
- Navigate to "OAuth & Permissions" in the sidebar
- Under "Scopes" -> "Bot Token Scopes", add:
  - `channels:history` (read messages in public channels)
  - `groups:history` (read messages in private channels)
  - `chat:write` (send messages)
  - `users:read` (resolve user names)
- Install the app to workspace
- Copy the "Bot User OAuth Token" (starts with `xoxb-`)

**Part 3: Enable Socket Mode (for slash commands)**
- Navigate to "Socket Mode" in the sidebar
- Toggle "Enable Socket Mode" to on
- Generate an app-level token with `connections:write` scope
- Copy the token (starts with `xapp-`)
- Navigate to "Slash Commands" in the sidebar
- Click "Create New Command"
- Set command name (e.g., `/kata`), description, and usage hint
- The Request URL is not needed (Socket Mode handles delivery)

**Part 4: Invite the Bot to Channels**
- In Slack, go to the channel where you want the bot
- Type `/invite @YourBotName`
- Or: Right-click the channel name -> "View channel details" -> "Integrations" -> "Add apps"
- Repeat for each channel

**Part 5: Get Channel IDs**
- Right-click a channel name in Slack -> "View channel details"
- Scroll to the bottom, copy the Channel ID (e.g., `C01ABCDEF`)
- Alternative: In the channel URL, the ID is after `/archives/` (e.g., `https://app.slack.com/client/T.../C01ABCDEF`)

**Part 6: Configure in Kata Agents**
- Open Settings -> Channels
- Click the "+" button to add a new channel
- Select "Slack" as the adapter type
- Enter a name for the channel (e.g., "my-team-slack")
- Paste the Bot Token (`xoxb-...`)
- Paste the App-Level Token (`xapp-...`) if you want slash command support
- Enter the Channel ID(s) from Part 5 (comma-separated for multiple channels)
- Optionally configure trigger patterns (regex) to filter which messages activate the agent
- Click "Create"
- Enable the daemon via the tray icon or Settings -> Channels -> Start Daemon

**Troubleshooting section:**
- "Bot not responding to messages": Check that the bot is invited to the channel, the channel ID is correct, and the daemon is running
- "Slash commands not working": Verify Socket Mode is enabled, the app-level token is entered, and the slash command is configured in the Slack app settings
- "Permission errors": Verify all required scopes are added and the app is reinstalled after adding new scopes
- "Messages appear twice": Check that trigger patterns don't match the bot's own messages (the adapter already filters by bot ID, but custom patterns could re-match)

Keep the guide concise. Use numbered steps within each section. Avoid marketing language. Reference the exact field names from the Kata Agents UI (Bot Token, App-Level Token, Channel IDs, Trigger Patterns).
  </action>
  <verify>
Verify the file exists and is well-formed markdown. Check that all referenced UI field names match those in ChannelSettingsPage.tsx.
  </verify>
  <done>
- Slack setup guide created at apps/electron/docs/slack-setup.md
- Covers app creation, scopes, Socket Mode, channel IDs, and Kata Agents configuration
- Includes troubleshooting section
- References actual UI field names
  </done>
</task>

<task type="checkpoint:human-verify">
  <name>Task 2: Verify guide accuracy against current Slack app dashboard</name>
  <files>apps/electron/docs/slack-setup.md</files>
  <action>
Present the completed guide to the user for review. The user should verify:
1. The Slack API dashboard navigation steps match the current UI (as of 2026)
2. The required OAuth scopes are correct and sufficient
3. The Kata Agents UI field names match what's actually displayed
4. The troubleshooting tips are relevant

Ask: "The Slack setup guide is ready at `apps/electron/docs/slack-setup.md`. Can you review it for accuracy against the current Slack API dashboard and Kata Agents UI?"
  </action>
  <verify>User confirms the guide is accurate or provides corrections.</verify>
  <done>User has reviewed and approved (or corrections have been applied to) the setup guide.</done>
</task>

</tasks>

<verification>
```bash
# Verify file exists
ls -la apps/electron/docs/slack-setup.md

# Verify markdown is valid (no broken links or formatting)
# Manual review by user
```
</verification>

<success_criteria>
- Slack setup guide exists at apps/electron/docs/slack-setup.md
- Guide covers all steps from Slack app creation through Kata Agents configuration
- Includes Socket Mode setup for slash commands
- Troubleshooting section addresses common issues
- User has reviewed and approved the guide content
</success_criteria>

<output>
After completion, create `.planning/phases/pending/18-channel-fit-and-finish/18-03-SUMMARY.md`
</output>
